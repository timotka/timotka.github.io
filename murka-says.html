<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ú—É—Ä–∫–∞ –∫–∞–∂–µ</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    body {
      background: black;
      color: lime;
      font-family: 'Share Tech Mono', monospace;
      padding: 2rem;
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .ascii {
      white-space: pre;
      font-size: 14px;
      margin-top: 1rem;
      line-height: 1.2;
      border: 1px dashed lime;
      display: inline-block;
      padding: 0.5rem;
      margin-bottom: 1rem;
    }

    .command {
      font-size: 1.5rem;
      margin: 2rem 0 1rem;
    }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .buttons button {
      background-color: #111;
      border: 1px solid lime;
      color: lime;
      padding: 1rem;
      font-size: 1rem;
      cursor: pointer;
      min-width: 120px;
    }

    .buttons button:hover {
      background-color: lime;
      color: black;
    }

    .result {
      margin-top: 1rem;
      font-size: 1.2rem;
    }

    .scoreboard {
      margin-top: 1rem;
      font-size: 1rem;
    }

    .timer {
      font-size: 1.2rem;
      margin-top: 1rem;
    }
  </style>
</head>
<body>

  <h1>üêæ –ú—É—Ä–∫–∞ –∫–∞–∂–µ</h1>
  <div class="ascii" id="murka"></div>
  <div class="command" id="command">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏...</div>
  <div class="buttons" id="buttons"></div>
  <div class="result" id="result"></div>
  <div class="scoreboard">
    ‚ù§Ô∏è –ñ–∏—Ç—Ç—è: <span id="lives">3</span> | ‚≠ê –û—á–∫–∏: <span id="score">0</span>
  </div>
  <div class="timer" id="timer">‚è≥ 5.0 —Å–µ–∫</div>

  <script>
    const allActions = [
      '–º—É—Ä—á–∞—Ç–∏', '–¥—Ä—è–ø–∞—Ç–∏', '–º—è—É–∫–∞—Ç–∏', '—Å—Ç–µ—Ä–µ–≥—Ç–∏',
      '–ø–ª–∏–≥–∞—Ç–∏', '—Ö–æ–≤–∞—Ç–∏—Å—å', '–≤–∏–ª–∏–∑—É–≤–∞—Ç–∏—Å—å', '–¥–∏–≤–∏—Ç–∏—Å—å –≤ —Å—Ç—ñ–Ω—É',
      '–ø–µ—Ä–µ–ø–∏—Å—É–≤–∞—Ç–∏ –∫–æ–¥', '–∫–æ—Ç–∏—Ç–∏—Å—è', '–¥–∏–≤–∏—Ç–∏—Å—å –≤ —Ç–µ–±–µ', '—á–∏—Ç–∞—Ç–∏ –¥—É–º–∫–∏'
    ];

    const murkaFaces = {
      success: `   |\\__/|\n  ( ^ w ^ )   \n   > Ô∏∂ <`,
      fail:    `   |\\__/|\n  ( >_< )   \n   > –¥ <`,
      idle:    `   |\\__/|\n  ( @_@ )   \n   > ‚àÄ <`
    };

    let currentAction = '';
    let isMurkaSaid = false;
    let score = 0;
    let lives = 3;
    let timerValue = 5.0;
    let interval;

    function getRandomActions(count) {
      const shuffled = [...allActions].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    }

    function newCommand() {
      clearInterval(interval);

      if (lives <= 0) return;

      timerValue = 5.0;
      updateTimer();

      const actions = getRandomActions(4);
      currentAction = actions[Math.floor(Math.random() * actions.length)];
      isMurkaSaid = Math.random() < 0.7;

      document.getElementById('command').innerText =
        (isMurkaSaid ? '–ú—É—Ä–∫–∞ –∫–∞–∂–µ: ' : '') + capitalize(currentAction) + '!';
      document.getElementById('result').innerText = '';
      updateMurka('idle');

      const buttonsContainer = document.getElementById('buttons');
      buttonsContainer.innerHTML = '';
      actions.forEach(action => {
        const btn = document.createElement('button');
        btn.innerText = capitalize(action);
        btn.onclick = () => respond(action);
        buttonsContainer.appendChild(btn);
      });

      interval = setInterval(() => {
        timerValue -= 0.1;
        updateTimer();
        if (timerValue <= 0) {
          clearInterval(interval);
          failTurn('‚è∞ –ó–∞–Ω–∞–¥—Ç–æ –ø–æ–≤—ñ–ª—å–Ω–æ!');
        }
      }, 100);
    }

    function respond(playerChoice) {
      clearInterval(interval);

      let outcome;
      if (playerChoice === currentAction && isMurkaSaid) {
        document.getElementById('result').innerText = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ, –º—É—Ä-–º—É—Ä!';
        score++;
        outcome = 'success';
      } else if (playerChoice === currentAction && !isMurkaSaid) {
        failTurn('‚ùå –ú—É—Ä–∫–∞ –∂ –Ω–µ –∫–∞–∑–∞–ª–∞!');
        return;
      } else if (playerChoice !== currentAction && isMurkaSaid) {
        failTurn('‚ùå –¢–∏ –Ω–µ –ø–æ—Å–ª—É—Ö–∞–≤ –ú—É—Ä–∫—É...');
        return;
      } else {
        document.getElementById('result').innerText = '‚úÖ –ú–æ–ª–æ–¥–µ—Ü—å, –Ω–µ –ø–æ–≤—ñ–≤—Å—è!';
        score++;
        outcome = 'success';
      }

      updateMurka(outcome);
      updateStats();
      setTimeout(newCommand, 1500);
    }

    function failTurn(message) {
      document.getElementById('result').innerText = message;
      updateMurka('fail');
      lives--;
      updateStats();
      if (lives > 0) {
        setTimeout(newCommand, 1500);
      } else {
        document.getElementById('command').innerText = 'üíÄ –ì—Ä—É –∑–∞–∫—ñ–Ω—á–µ–Ω–æ';
      }
    }

    function updateMurka(state) {
      document.getElementById('murka').innerHTML = `<pre>${murkaFaces[state]}</pre>`;
    }

    function updateStats() {
      document.getElementById('score').innerText = score;
      document.getElementById('lives').innerText = lives;
    }

    function updateTimer() {
      document.getElementById('timer').innerText = `‚è≥ ${timerValue.toFixed(1)} —Å–µ–∫`;
    }

    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    newCommand();
  </script>
</body>
</html>
