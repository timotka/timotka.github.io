<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ú—É—Ä–∫–∞ –∫–∞–∂–µ</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    body {
      background: black;
      color: lime;
      font-family: 'Share Tech Mono', monospace;
      padding: 2rem;
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .ascii {
      white-space: pre;
      font-size: 14px;
      margin-top: 1rem;
    }

    .command {
      font-size: 1.5rem;
      margin: 2rem 0;
    }

    .buttons button {
      background-color: #111;
      border: 1px solid lime;
      color: lime;
      padding: 1rem;
      margin: 1rem;
      font-size: 1rem;
      cursor: pointer;
    }

    .buttons button:hover {
      background-color: lime;
      color: black;
    }

    .result, .scoreboard {
      margin-top: 2rem;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>

  <h1>üêæ –ú—É—Ä–∫–∞ –∫–∞–∂–µ</h1>
  <div class="ascii" id="murka">
<pre>
   |\__/|
  ( @_@ )   < –ú—è—É...
   > ‚àÄ <
</pre>
  </div>
  <div class="command" id="command">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏...</div>
  <div class="buttons" id="buttons"></div>
  <div class="result" id="result"></div>
  <div class="scoreboard">
    ‚ù§Ô∏è –ñ–∏—Ç—Ç—è: <span id="lives">3</span> | ‚≠ê –û—á–∫–∏: <span id="score">0</span>
  </div>

  <script>
    const allActions = [
      '–º—É—Ä—á–∞—Ç–∏', '–¥—Ä—è–ø–∞—Ç–∏', '–º—è—É–∫–∞—Ç–∏', '—Å—Ç—Ä–∏–±–∞—Ç–∏', '–ø–∏—Ç–∏ –º–æ–ª–æ–∫–æ', '–¥–∏–≤–∏—Ç–∏—Å—è –≤ —Å—Ç—ñ–Ω—É',
      '–ª–∏–∑–∞—Ç–∏ –ª–∞–ø—É', '–≥–æ–π–¥–∞—Ç–∏—Å—è', '–≤–∏—Å—ñ—Ç–∏ –Ω–∞ —à—Ç–æ—Ä–∞—Ö', '–∑–∞–¥—Ä—ñ–º–∞—Ç–∏', '—à–∏–ø—ñ—Ç–∏', '–ø–æ–ª—é–≤–∞—Ç–∏ –Ω–∞ –Ω—ñ—â–æ'
    ];

    const murkaFaces = {
      success: `   |\__/|\n  ( ^ w ^ )   < –ú—è—É~\n   > Ô∏∂ <`,
      fail:    `   |\__/|\n  ( >_< )   < –ú—è—É?!\n   > –¥ <`,
      idle:    `   |\__/|\n  ( @_@ )   < –ú—è—É...\n   > ‚àÄ <`
    };

    let currentAction = '';
    let isMurkaSaid = false;
    let lives = 3;
    let score = 0;
    let timeLimit = 5000;
    let timeoutId;

    function shuffle(array) {
      const arr = array.slice();
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function newCommand() {
      clearTimeout(timeoutId);

      const shuffledActions = shuffle(allActions);
      const buttonActions = shuffledActions.slice(0, 4);
      currentAction = buttonActions[Math.floor(Math.random() * buttonActions.length)];
      isMurkaSaid = Math.random() < 0.7;

      const cmdText = (isMurkaSaid ? '–ú—É—Ä–∫–∞ –∫–∞–∂–µ: ' : '') + capitalize(currentAction) + '!';
      document.getElementById('command').innerText = cmdText;
      document.getElementById('result').innerText = '';
      updateMurka('idle');

      const buttonsDiv = document.getElementById('buttons');
      buttonsDiv.innerHTML = '';
      buttonActions.forEach(action => {
        const btn = document.createElement('button');
        btn.innerText = capitalize(action);
        btn.onclick = () => respond(action);
        buttonsDiv.appendChild(btn);
      });

      timeoutId = setTimeout(() => {
        loseLife('‚è±Ô∏è –ó–∞–ø—ñ–∑–Ω–æ! –ú—É—Ä–∫–∞ –Ω–µ —á–µ–∫–∞—Ç–∏–º–µ –≤—ñ—á–Ω–æ.');
      }, timeLimit);
    }

    function respond(playerChoice) {
      clearTimeout(timeoutId);
      let outcome;

      if (playerChoice === currentAction && isMurkaSaid) {
        score++;
        if (timeLimit > 2000) timeLimit -= 300;
        document.getElementById('result').innerText = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ, –º—É—Ä-–º—É—Ä!';
        outcome = 'success';
      } else if (playerChoice === currentAction && !isMurkaSaid) {
        loseLife('‚ùå –ú—É—Ä–∫–∞ –Ω–µ –∫–∞–∑–∞–ª–∞!');
        outcome = 'fail';
      } else if (playerChoice !== currentAction && isMurkaSaid) {
        loseLife('‚ùå –¢–∏ –Ω–µ –ø–æ—Å–ª—É—Ö–∞–≤ –ú—É—Ä–∫—É...');
        outcome = 'fail';
      } else {
        score++;
        if (timeLimit > 2000) timeLimit -= 300;
        document.getElementById('result').innerText = '‚úÖ –ú–æ–ª–æ–¥–µ—Ü—å, –Ω–µ –ø–æ–≤—ñ–≤—Å—è!';
        outcome = 'success';
      }

      updateMurka(outcome);
      updateScoreboard();
      if (lives > 0) setTimeout(newCommand, 1500);
    }

    function loseLife(message) {
      lives--;
      document.getElementById('result').innerText = message;
      updateScoreboard();
      if (lives <= 0) {
        document.getElementById('command').innerText = 'üíÄ –ì—Ä—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
        document.getElementById('buttons').innerHTML = '';
      }
    }

    function updateMurka(state) {
      document.getElementById('murka').innerHTML = `<pre>${murkaFaces[state]}</pre>`;
    }

    function updateScoreboard() {
      document.getElementById('lives').innerText = lives;
      document.getElementById('score').innerText = score;
    }

    function capitalize(str) {
      return str.charAt(0).toUpperCase() + str.slice(1);
    }

    newCommand();
  </script>
</body>
</html>
